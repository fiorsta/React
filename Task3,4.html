<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Task 3, 4</title>
</head>

<body>
    <script>
        class Human {
            constructor(name, age, dateOfBirth) {
                this.name = name,
                    this.age = age,
                    this.dateOfBirth = dateOfBirth;
            }
            displayInfo() {
                return `${this.name}, ${this.age} Дата рождения: ${this.dateOfBirth}`;
            }
        }

        class Employee extends Human {
            constructor(name, age, dateOfBirth, salary, department) {
                super(name, age, dateOfBirth);
                this.salary = salary,
                    this.department = department;
            }
            displayInfo() {
                return `${super.displayInfo()} Заработная плата: ${this.salary} Отдел: ${this.department}`;
            }
        }

        class Developer extends Employee {
            constructor(name, age, dateOfBirth, salary, department, managerOfDepartment) {
                super(name, age, dateOfBirth, salary, department);
                this.managerOfDepartment = managerOfDepartment;
            }
            setManager(name, age, dateOfBirth, salary) {
                let man = new Manager(name, age, dateOfBirth, salary, this.department);
                man.developersOfDepartment.push(this);
                this.managerOfDepartment = man;
                console.log(`${this.name} назначил менеджера ${this.managerOfDepartment.displayInfo()}`);
                console.log(`В подчинении у ${this.managerOfDepartment.name} следующие разработчики:`);
                console.log(this.managerOfDepartment.developersOfDepartment);
            }
        }

        class Manager extends Employee {
            constructor(name, age, dateOfBirth, salary, department) {
                super(name, age, dateOfBirth, salary, department);
                this.developersOfDepartment = [];
            }
            addDeveloper(name, age, dateOfBirth, salary) {
                let newDeveloper = new Developer(name, age, dateOfBirth, salary, this.department, this);
                this.developersOfDepartment.push(newDeveloper);
                console.log(`${this.name} добавил в команду нового разработчика ${newDeveloper.displayInfo()}`);
                console.log(`Теперь в подчинении у ${this.name} следующие разработчики:`);
                console.log(this.developersOfDepartment);
            }
            removeDeveloper(name, age, dateOfBirth, salary) {
                let find = this.developersOfDepartment.find(man => man.name == name);
                let index = this.developersOfDepartment.indexOf(find);
                if (find) {
                    find.managerOfDepartment = {};
                    this.developersOfDepartment.splice(index, 1);
                    console.log(`В подчинении у ${this.name} следующие разработчики:`);
                    console.log(this.developersOfDepartment);
                    console.log(`${this.name} больше не менеджер для ${find.name}.`);
                    console.log(`${find.displayInfo()} теперь свободный художник:`);
                    console.log(`${find.managerOfDepartment}`);
                } else {
                    console.log(`${this.name} не может управлять ${name}.`);
                    console.log(`В подчинении у ${this.name} следующие разработчики:`);
                    console.log(this.developersOfDepartment);
                }
            }
        }

        window.onload = () => {
            let developer = new Developer('Peter', 25, '13.12.1994', 15500, 'Web');
            developer.setManager('Ann', 26, '14.08.1993', 13000);

            let manager = new Manager('Kate', 28, '5.03.1991', 14000, 'Sale');
            manager.addDeveloper('Lous', 24, '8.09.1995', 12000);
            manager.addDeveloper('Mia', 30, '9.05.1989', 12000);
            
            manager.removeDeveloper('Lous', 24, '8.09.1995', 12000);

        }

        /*
        Написать цикл, который создаёт массив промисов, внутри каждого промиса происходит обращение к ресурсу (https://jsonplaceholder.typicode.com/users/number), где вместо number подставляется число от 1 до 10, в итоге должно получиться 10 промисов. Следует дождаться выполнения загрузки всеми промисами и далее вывести массив загруженных данных.
         */

        let arrayOfPromises = [];

        for (let i = 1; i < 11; i++) {
            arrayOfPromises.push(fetch(`https://jsonplaceholder.typicode.com/users/${i}`)
                .then(result => result.json()));
        }

        Promise.all(arrayOfPromises)
            .then(data => console.log(data));

    </script>
</body>

</html>
